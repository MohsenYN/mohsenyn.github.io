---
layout: default
title: Resources
permalink: /Resource/
---

<header class="page-header">
  <h1 style="font-size: 2.5rem; margin: 0 auto 1rem; font-weight: 700; letter-spacing: 1px; text-align: center; width: 100%; display: block;">Resources</h1>
  <p>Explore our latest dry bean varieties and connect with distributors for licensing and inquiries.</p>
</header>

<div class="resource-container">
  <!-- New Varieties Section -->
  <section class="new-varieties">
    <h2>New Dry Bean Varieties</h2>
    <p>We’re excited to announce the upcoming release of innovative dry bean varieties developed through advanced computational breeding at the University of Guelph. These varieties offer enhanced yield, disease resistance, and adaptability to diverse climates, supporting sustainable agriculture for growers across North America.</p>
    <div class="variety-grid">
      <div class="variety-box">
        <img src="/assets/Lines/Bechamel.jpg" alt="OAC Bechamel" class="variety-img">
        <h3>OAC Bechamel</h3>
        <ul>
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>
          <li> Excellent upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Resilient.jpg" alt="OAC Resilient" class="variety-img">
        <h3>OAC Resilient</h3>
        <ul>
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>
          <li> Very good upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Plasma.jpg" alt="Plasma" class="variety-img">
        <h3>OAC Plasma</h3>
        <ul>
          <li> Mid Maturity</li>
          <li> High Yield</li>
          <li> Anthracnose race 73 resistant</li>          
          <li> Tolerant to common bacterial blight</li>          
          <li> Excellent upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Storm.jpg" alt="6OAC Storm" class="variety-img">
        <h3>OAC Storm</h3>
        <ul>
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>          
          <li> Tolerant to common bacterial blight</li>          
          <li> Excellent upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Agate.jpg" alt="OAC Agate" class="variety-img">
        <h3>OAC Agate</h3>
        <ul>
          <li> Mid Maturity</li>
          <li> Very Good Yield</li>
          <li> Anthracnose race 73 resistant</li>          
          <li> Very Good Coocking Quality</li>          
          <li> Very Good upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Candycane.jpg" alt="OAC Candycane" class="variety-img">
        <h3>OAC Candycane</h3>
        <ul>
          <li> Mid Maturity</li>
          <li> Excellent Yield</li>
          <li> Good Seed Size</li>          
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/volterra.jpg" alt="OAC Volterra" class="variety-img">
        <h3>OAC Volterra </h3>
        <ul>
          <li> Mid Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>                    
          <li> Excellent upright plant architecture for direct combining</li>
        </ul>
      </div>
      <div class="variety-box">
        <img src="/assets/Lines/Firebrand.jpg" alt="OAC Firebrand" class="variety-img">
        <h3>OAC Firebrand </h3>
        <ul>
          <li> Light Red</li>    
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>                    
          <li> Excellent upright plant architecture for direct combining</li>
          <li> Good Seed Size</li>    
        </ul>
      </div>
       <div class="variety-box">
        <img src="/assets/Lines/Jasper.jpg" alt="OAC Jasper" class="variety-img">
        <h3>OAC Jasper </h3>
        <ul>
          <li> Dark Red</li>    
          <li> Mid Maturity</li>
          <li> Good Yield</li>
          <li> Anthracnose race 73 resistant</li>                    
          <li> Good upright plant architecture for direct combining</li>
          <li> Large Seed Size</li>    
        </ul>
      </div>
       <div class="variety-box">
        <img src="/assets/Lines/o18hr0037.jpg" alt="O18HR003y" class="variety-img">
        <h3>O18HR003y </h3>
        <ul>
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>
          <li> Tolerant to common bacterial blight</li>              
          <li> Good upright plant architecture for direct combining</li>
        </ul>
      </div>
       <div class="variety-box">
        <img src="/assets/Lines/O18HR007y.jpg" alt="O18HR007y" class="variety-img">
        <h3>O18HR007y </h3>
        <ul>
          <li> Full Maturity</li>
          <li> Excellent Yield</li>
          <li> Anthracnose race 73 resistant</li>
          <li> Tolerant to common bacterial blight</li>              
          <li> Good upright plant architecture for direct combining</li>
        </ul>
      </div>
    </div>
    <p>For detailed licensing information, download our <a href="/assets/pdf/Dry Beans CFP JAN2025 - LIGHT.pdf" target="_blank" rel="noopener noreferrer" class="pdf-link">Call for Licensing PDF</a> or contact the <a href="https://www.uoguelph.ca/research/innovation/" target="_blank" rel="noopener noreferrer" class="pdf-link">Research Innovation Office</a>.</p>
    <div class="contact-box">
      <img src="/assets/img/team/steve.jpg" alt="Steve Dinka" class="contact-img">
      <div class="contact-details">
        <h3>Steve Dinka</h3>
        <p><strong>Technology Transfer Manager, Germplasm</strong></p>
        <p>Works with plant breeders, government, industry leaders, companies, and growers to increase the commercial impact of new U of G plant varieties.</p>
        <p>Email: <a href="mailto:germplasm@uoguelph.ca" class="pdf-link">germplasm@uoguelph.ca</a></p>
      </div>
    </div>
  </section>

  <!-- Crop Comparison Tool -->
  <section class="crop-comparison">
    <h2>Compare Dry Bean Varieties</h2>
    <h3 class="formInfo">Select a Crop</h3>
    <div class="buttons form">
      <button id="whiteBean" class="gradientBtn">White Bean</button>
      <button id="minor" class="gradientBtn">Coloured Bean Minor</button>
      <button id="major" class="gradientBtn">Coloured Bean Major</button>
    </div>
	<p class="form">If you run into an error, please refresh the page and attempt it again </p>
    <p class="form">* "--" represents data not existing due to time since bean registration.</p>
    <p class="form">* For more information, consider visiting the <a target="_blank" href="https://pulse.gocrops.ca/" rel="noopener">Ontario Pulse Crops Committee</a> Official Website.</p>
    <h4 class="selectors">Select varieties to compare</h4>
    <form class="beanForm selectors" id="beanForm"></form>
    <h4 class="selectors">Select at least one response to compare</h4>
    <form class="beanForm selectors" id="dataForm">
      <ul>
        <li><label><input type="checkbox" value="description"><span class="checkmark"></span> Description</label></li>
        <li><label><input type="checkbox" value="diseaseRatings"><span class="checkmark"></span> Disease Ratings</label></li>
        <li><label><input type="checkbox" value="performance"><span class="checkmark"></span> Performance Metrics</label></li>
      </ul>
      <input id="goBack" class="gradientBtn" type="submit" value="Go Back">
      <input id="submitBtnData" class="gradientBtn" type="submit" value="Submit">
    </form>
    <div id="error">
      <p>Error. Please ensure you have selected at least two beans and at least one response to compare.</p>
      <button id="closeError" class="gradientBtn">Try Again</button>
    </div>
    <div id="tables"></div>
  </section>

  <!-- Distributors Section -->
  <section class="distributors">
    <h2>Dry Bean Variety Distributors</h2>
    <div class="distributor-grid">
      <div class="distributor-item">
        <img src="/assets/img/dist/H.jpg" alt="Hensall Co-op Logo" class="distributor-logo">
        <h3>Hensall Co-op</h3>
        <p>P.O. Box 219<br>Hensall, ON N0M 1X0<br>Tel: 1-877-567-1678<br><a href="https://hensallco-op.ca/" target="_blank" rel="noopener noreferrer">hensallco-op.ca</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/BS.jpg" alt="R.T. Bolton and Sons Logo" class="distributor-logo">
        <h3>R.T. Bolton and Sons</h3>
        <p>43234 Winthrop Road, RR#1<br>Dublin, ON N0K 1E0<br>Tel: (519) 525-6430<br><a href="https://secan.com/members/rt-bolton-sons" target="_blank" rel="noopener noreferrer">secan.com/members/rt-bolton-sons</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/PLOVGH.jpg" alt="Plovgh, Inc. Logo" class="distributor-logo">
        <h3>Plovgh, Inc.</h3>
        <p>P.O. Box 295<br>Viroqua, WI 54665<br>Tel: 1-877-567-1678<br><a href="https://www.plovgh.com" target="_blank" rel="noopener noreferrer">www.plovgh.com</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/Underwood.png" alt="Underwood Grain Ltd. Logo" class="distributor-logo">
        <h3>Underwood Grain Ltd.</h3>
        <p>41797 Howick-Turnberry Road<br>Wingham, ON N0G 2W0<br>Tel: 519-335-3579<br><a href="https://www.underwoodgrain.com" target="_blank" rel="noopener noreferrer">www.underwoodgrain.com</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/TV.jpg" alt="Treasure Valley Seed Co. Logo" class="distributor-logo">
        <h3>Treasure Valley Seed Co.</h3>
        <p>4633 E. River Road<br>Freeland, MI 48623<br><a href="https://tvseed.com" target="_blank" rel="noopener noreferrer">tvseed.com</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/MS.png" alt="Meridian Seeds Logo" class="distributor-logo">
        <h3>Meridian Seeds</h3>
        <p>16553 37th St SE, Suite 3<br>Mapleton, ND 58059<br>Tel: 1-866-282-SEED<br><a href="https://meridianseeds.com" target="_blank" rel="noopener noreferrer">meridianseeds.com</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/CSL.jpg" alt="Columbia Seed Co. Logo" class="distributor-logo">
        <h3>Columbia Seed Co.</h3>
        <p>409-2nd Avenue South<br>Vauxhall, AB T0K 2K0<br>Tel: 403-654-2158<br><a href="https://www.columbiaseed.ca" target="_blank" rel="noopener noreferrer">www.columbiaseed.ca</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/JF.jpg" alt="Jefferies Seeds Logo" class="distributor-logo">
        <h3>Jefferies Seeds</h3>
        <p>Box 582<br>Glenboro, MB R0K 0X0<br>Tel: 204-827-2102<br><a href="https://jefferiesseeds.com" target="_blank" rel="noopener noreferrer">jefferiesseeds.com</a></p>
      </div>
      <div class="distributor-item">
        <img src="/assets/img/dist/CCA.png" alt="Crooked Creek Acres Logo" class="distributor-logo">
        <h3>Crooked Creek Acres</h3>
        <p>1584 Melwood Drive<br>Strathroy, ON N7G 3H5<br>Tel: 519-247-3530<br><a href="https://ccacres.ca" target="_blank" rel="noopener noreferrer">ccacres.ca</a></p>
      </div>
    </div>
  </section>
</div>

<style>
  /* Header Styling */
  .page-header {
    text-align: center;
    padding: 3rem 1rem;
    background: linear-gradient(135deg, #4a2c5f 0%, #8e4b7e 100%);
    color: #fff;
    border-bottom: 4px solid #f4c430;
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    box-sizing: border-box;
  }
  .page-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 auto 0.5rem;
    letter-spacing: 1px;
    animation: fadeIn 1s ease-in;
    display: inline-block;
  }
  .page-header p {
    font-size: 1.3rem;
    font-style: italic;
    opacity: 0.9;
    margin: 0;
    max-width: 800px;
    display: inline-block;
  }

  /* Resource Container */
  .resource-container {
    max-width: 1200px;
    margin: 4rem auto;
    padding: 0 1rem;
  }

  /* New Varieties Section */
  .new-varieties {
    margin-bottom: 4rem;
  }
  .new-varieties h2 {
    color: #9b1d64;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    border-bottom: 3px solid #f4c430;
    display: inline-block;
  }
  .new-varieties p {
    font-size: 1.1rem;
    line-height: 1.7;
    color: #333;
    margin-bottom: 1.5rem;
  }
  .variety-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }
  .variety-box {
    background: linear-gradient(135deg, #fff 0%, #f9e6ed 100%);
    border-radius: 15px;
    padding: 1.5rem;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
    border: 2px solid #9b1d64;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }
  .variety-box:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    border-color: #d94f8e;
  }
  .variety-img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 10px;
    margin-bottom: 1rem;
  }
  .variety-box h3 {
    color: #9b1d64;
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
  }
  .variety-box ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .variety-box li {
    font-size: 1rem;
    color: #333;
    padding-left: 1.5rem;
    position: relative;
  }
  .variety-box li:before {
    content: "➔";
    color: #d94f8e;
    font-size: 1.2rem;
    position: absolute;
    left: 0;
  }
  .pdf-link {
    color: #9b1d64;
    font-weight: 600;
    text-decoration: none;
    transition: color 0.3s;
  }
  .pdf-link:hover {
    color: #d94f8e;
  }
  .contact-box {
    display: flex;
    align-items: center;
    background: #fff;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
    margin-top: 2rem;
    border-left: 6px solid #f4c430;
  }
  .contact-img {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    margin-right: 1.5rem;
    object-fit: cover;
  }
  .contact-details h3 {
    color: #9b1d64;
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  .contact-details p {
    font-size: 1rem;
    color: #333;
    margin: 0.5rem 0;
  }

  /* Crop Comparison Section */
  .crop-comparison {
    margin-bottom: 4rem;
  }
  .crop-comparison h2 {
    color: #9b1d64;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    border-bottom: 3px solid #f4c430;
    display: inline-block;
  }
  .formInfo {
    color: #333;
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0.5rem 0 1rem;
  }
  .buttons {
    display: flex;
    flex-direction: row;
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 1em;
  }
  .buttons .gradientBtn {
    width: 33%;
    margin: 0.2em;
    padding: 10px;
    font-weight: 700;
    font-size: 20px;
    border-image-source: linear-gradient(to top, #C20430, maroon);
    border-image-slice: 1;
    background: #fff;
    cursor: pointer;
    transition: background 0.3s;
  }
  .buttons .gradientBtn:hover {
    background: #f9e6ed;
  }
  .form {
    font-size: 1rem;
    color: #555;
    margin: 0.5rem 0;
  }
  .form a {
    color: #9b1d64;
    text-decoration: none;
  }
  .form a:hover {
    color: #d94f8e;
  }
  .selectors {
    color: #333;
    font-size: 1.2rem;
    font-weight: 500;
    margin: 1rem 0;
    display: none;
  }
  .beanForm {
    margin-top: 0.5em;
  }
  .beanForm label {
    display: block;
    position: relative;
    cursor: pointer;
    user-select: none;
    padding-left: 3.5vh;
    font-size: 1rem;
    color: #333;
  }
  .beanForm label input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
  }
  .beanForm .checkmark {
    position: absolute;
    top: 0;
    left: 0;
    height: 25px;
    width: 25px;
    background-color: #eee;
  }
  .beanForm label:hover input ~ .checkmark {
    background-color: #ccc;
  }
  .beanForm label input:checked ~ .checkmark {
    background-color: #c20430;
  }
  .checkmark:after {
    content: "";
    position: absolute;
    display: none;
  }
  .beanForm input:checked ~ .checkmark:after {
    display: block;
  }
  .beanForm label .checkmark:after {
    left: 9px;
    top: 5px;
    width: 5px;
    height: 10px;
    border: solid white;
    border-width: 0 3px 3px 0;
    transform: rotate(45deg);
  }
  #goBack, #submitBtnData {
    width: calc(50% - 1em);
    margin: 0.5em;
    padding: 10px;
    font-weight: 700;
    font-size: 20px;
    border-image-source: linear-gradient(to top, #C20430, maroon);
    border-image-slice: 1;
    background: #fff;
    cursor: pointer;
    transition: background 0.3s;
  }
  #goBack:hover, #submitBtnData:hover {
    background: #f9e6ed;
  }
  #goBack {
    float: left;
  }
  #submitBtnData {
    float: right;
  }
  #error {
    text-align: center;
    padding: 1rem;
    background: #ffe6e6;
    border-radius: 8px;
    margin: 1rem 0;
    display: none;
  }
  #error p {
    color: #c20430;
    font-size: 1.1rem;
    margin: 0 0 1rem;
  }
  #closeError {
    padding: 10px 20px;
    font-weight: 700;
    font-size: 18px;
    border-image-source: linear-gradient(to top, #C20430, maroon);
    border-image-slice: 1;
    background: #fff;
    cursor: pointer;
    transition: background 0.3s;
  }
  #closeError:hover {
    background: #f9e6ed;
  }
  #tables {
    display: none;
  }
  #tables table {
    border: 2px solid black;
    margin-bottom: 10px;
    width: 100%;
  }
  #tables td {
    border: 1px solid black;
    padding: 5px;
  }
  #tables table tr:nth-of-type(1) {
    color: #C20430;
    font-weight: 900;
    font-size: 1.3em;
  }
  #tables tr:nth-of-type(even) {
    background: #e5e5e5;
  }
  #tables tr:nth-of-type(odd) {
    background: #f7f7f7;
  }
  #tables tr:nth-of-type(1) {
    background: white;
  }
  #tables table tr:nth-of-type(2) {
    font-weight: 600;
  }
  #diseaseRating tr:nth-of-type(3) {
    font-weight: 500;
  }
  #newComparison, #exportCSV {
    width: 100%;
    margin-bottom: 5px;
    padding: 10px;
    font-weight: 900;
    font-size: 20px;
    border-image-source: linear-gradient(to top, #C20430, maroon);
    border-image-slice: 1;
    background: #fff;
    cursor: pointer;
    transition: background 0.3s;
  }
  #newComparison:hover, #exportCSV:hover {
    background: #f9e6ed;
  }

  /* Distributors Section */
  .distributors {
    margin-bottom: 4rem;
  }
  .distributors h2 {
    color: #9b1d64;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    border-bottom: 3px solid #f4c430;
    display: inline-block;
  }
  .distributor-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }
  .distributor-item {
    background: #fff;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    border-left: 8px solid #9b1d64;
    transition: all 0.3s ease;
  }
  .distributor-item:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  }
  .distributor-logo {
    width: 80px;
    height: auto;
    margin-bottom: 1rem;
  }
  .distributor-item h3 {
    color: #9b1d64;
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
  }
  .distributor-item p {
    font-size: 1rem;
    line-height: 1.6;
    color: #333;
    margin: 0;
  }
  .distributor-item a {
    color: #9b1d64;
    text-decoration: none;
    transition: color 0.3s;
  }
  .distributor-item a:hover {
    color: #d94f8e;
  }

  /* Animation */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Responsive Design */
  @media (max-width: 600px) {
    .page-header h1 {
      font-size: 2rem;
    }
    .page-header p {
      font-size: 1.1rem;
    }
    .new-varieties h2, .crop-comparison h2, .distributors h2 {
      font-size: 1.5rem;
    }
    .variety-grid, .distributor-grid {
      grid-template-columns: 1fr;
    }
    .buttons {
      flex-direction: column;
    }
    .buttons .gradientBtn {
      width: 100%;
    }
    #goBack, #submitBtnData {
      width: 100%;
      margin: 0.5em 0;
    }
    .contact-box {
      flex-direction: column;
      text-align: center;
    }
    .contact-img {
      margin: 0 auto 1rem;
    }
  }
</style>

<!-- Include SheetJS library for Excel parsing -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<!-- JavaScript for Crop Comparison Tool -->
<script>
// Global variables
let checkedBeans = [];
let checkedData = [];
let allBeans = [];

class Bean {
  constructor(name, marketClass, year, commonMosaicVirus, anthracnose, commonBlight, yieldB, maturity, oneHundredSdWeight, directHarvestSuitability) {
    this.name = name;
    this.marketClass = marketClass;
    this.year = year;
    this.commonMosaicVirus = commonMosaicVirus;
    this.anthracnose = anthracnose;
    this.commonBlight = commonBlight;
    this.yieldB = yieldB;
    this.maturity = maturity;
    this.oneHundredSdWeight = oneHundredSdWeight;
    this.directHarvestSuitability = directHarvestSuitability;
  }

  createDescriptionRow() {
    return `<tr><td>${this.name}</td><td>${this.marketClass}</td><td>${this.year}</td></tr>`;
  }

  createDiseaseRow() {
    return `<tr><td>${this.name}</td><td>${this.commonMosaicVirus[0]}</td><td>${this.commonMosaicVirus[1]}</td><td>${this.anthracnose[0]}</td><td>${this.anthracnose[1]}</td><td>${this.anthracnose[2]}</td><td>${this.commonBlight}</td></tr>`;
  }

  createPerformanceRow() {
    const formatNumber = (value) => value === "--" || value === null ? "--" : Number(value).toFixed(2);
    return `<tr><td>${this.name}</td><td>${formatNumber(this.yieldB)}</td><td>${formatNumber(this.maturity)}</td><td>${formatNumber(this.oneHundredSdWeight)}</td><td>${formatNumber(this.directHarvestSuitability)}</td></tr>`;
  }
}

const TABLE = {
  createDescriptionTable: function(beans) {
    let HTML = "<table id='description'><tr><td colspan='3'>Variety Description</td></tr>";
    HTML += "<tr><td>Variety</td><td>Market Class</td><td>Year of Registration</td></tr>";
    beans.forEach(bean => HTML += bean.createDescriptionRow());
    HTML += "</table>";
    return HTML;
  },
  createDiseaseTable: function(beans) {
    let HTML = "<table id='diseaseRating'><tr><td colspan='7'>Disease Ratings</td></tr>";
    HTML += "<tr><td>Variety</td><td colspan='2'>Bean Common Mosaic Virus</td><td colspan='3'>Anthracnose</td><td>Common Blight</td></tr>";
    HTML += "<tr><td></td><td>R 1</td><td>R 15</td><td>R 17</td><td>R 23</td><td>R 73</td><td></td></tr>";
    beans.forEach(bean => HTML += bean.createDiseaseRow());
    HTML += "</table>";
    return HTML;
  },
  createPerformanceTable: function(beans) {
    let HTML = "<table id='performance'><tr><td colspan='5'>Performance Metrics</td></tr>";
    HTML += "<tr><td>Variety</td><td>Yield (lbs/acre)</td><td>Maturity (days)</td><td>100 Seed Weight (g)</td><td>Direct Harvest Suitability (1-5)</td></tr>";
    beans.forEach(bean => HTML += bean.createPerformanceRow());
    HTML += "</table>";
    return HTML;
  },
  createTables: function(beans, parameters) {
    let HTML = "";
    if (parameters.includes("description")) HTML += this.createDescriptionTable(beans);
    if (parameters.includes("diseaseRatings")) HTML += this.createDiseaseTable(beans);
    if (parameters.includes("performance")) HTML += this.createPerformanceTable(beans);
    HTML += "<button id='exportCSV'>Export as CSV</button>";
    HTML += "<button id='newComparison'>Start a New Comparison</button>";
    return HTML;
  }
};

function convertStringToBean(name) {
  return allBeans.find(bean => bean.name === name);
}

function convertArrToBean(arr) {
  return arr.map(name => convertStringToBean(name)).filter(bean => bean);
}

function uncheckBoxes() {
  const dataForm = document.getElementById("dataForm");
  const beanForm = document.getElementById("beanForm");
  if (dataForm) {
    let checkboxes = dataForm.getElementsByTagName("input");
    for (let i = 0; i < checkboxes.length; i++) { checkboxes[i].checked = false; }
  }
  if (beanForm) {
    let checkboxes = beanForm.getElementsByTagName("input");
    for (let i = 0; i < checkboxes.length; i++) { checkboxes[i].checked = false; }
  }
}

let selected = false;
function selectAllCheckboxes(className) {
  console.log(`Selecting all for ${className}, current state: ${selected}`);
  const beanForm = document.getElementById("beanForm");
  if (!beanForm) return;
  let checkboxes = beanForm.getElementsByTagName("li");
  for (let i = 0; i < checkboxes.length; i++) {
    if (checkboxes[i].classList.contains(className)) {
      checkboxes[i].getElementsByTagName("input")[0].checked = !selected;
    }
  }
  selected = !selected;
}

function createFormFromBeansList(className) {
  console.log(`Creating form for ${className}, allBeans length: ${allBeans.length}`);
  let beansList = allBeans.filter(bean => {
    if (className === "whiteNavy") return bean.marketClass === "White Navy";
    if (className === "minorClass") return !["White Navy", "Light Red Kidney", "Dark Red Kidney", "White Kidney", "Cranberry"].includes(bean.marketClass);
    if (className === "majorClass") return ["Light Red Kidney", "Dark Red Kidney", "White Kidney", "Cranberry"].includes(bean.marketClass);
  });
  if (beansList.length === 0) {
    console.warn(`No beans found for ${className}`);
    return "<p>No varieties available for this category.</p>";
  }
  let HTML = "<ul>";
  beansList.forEach(bean => {
    let additionalMarketInfo = className === "whiteNavy" ? "" : " (" + bean.marketClass + ")";
    HTML += `<li class="${className}"><label><input type="checkbox" value="${bean.name}"><span class="checkmark"></span> ${bean.name}${additionalMarketInfo}</label></li>`;
  });
  HTML += "</ul>";
  HTML += `<button id="selectAll${className}" class="gradientBtn">Select All</button>`;
  return HTML;
}

function exportAsCSV() {
  console.log("Exporting as CSV...");
  const tables = document.getElementById("tables");
  if (!tables) return;
  let csv = "";
  let tableElements = tables.getElementsByTagName("table");
  for (let table of tableElements) {
    let trs = table.getElementsByTagName("tr");
    for (let tr of trs) {
      let tds = tr.getElementsByTagName("td");
      for (let td of tds) {
        csv += `${td.innerHTML},`;
      }
      csv += "\n";
    }
    csv += "\n\n";
  }
  const blob = new Blob([csv], { type: "text/csv" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "bean_comparison.csv";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  console.log("CSV exported successfully");
}

async function loadBeanData() {
  try {
    const response = await fetch('/assets/data/beans.xlsx');
    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    const arrayBuffer = await response.arrayBuffer();
    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    const jsonData = XLSX.utils.sheet_to_json(sheet);

    allBeans = jsonData.map(row => new Bean(
      row["Name"],
      row["Market Class"],
      row["Year"],
      [row["Common Mosaic Virus R1"] || "--", row["Common Mosaic Virus R15"] || "--"],
      [row["Anthracnose R17"] || "--", row["Anthracnose R23"] || "--", row["Anthracnose R73"] || "--"],
      row["Common Blight"] || "--",
      row["Yield (lbs/acre)"] || "--",
      row["Maturity (days)"] || "--",
      row["100 Sd Weight (g)"] || "--",
      row["Direct Harvest Suitability"] || "--"
    ));
    console.log("Beans loaded successfully:", allBeans.length);
  } catch (error) {
    console.error("Error loading bean data:", error);
    const beanForm = document.getElementById("beanForm");
    if (beanForm) beanForm.innerHTML = "<p>Error loading data. Please try again later.</p>";
  }
}

function setupEventListeners() {
  console.log("Setting up event listeners...");
  const whiteBeanBtn = document.getElementById("whiteBean");
  const minorBtn = document.getElementById("minor");
  const majorBtn = document.getElementById("major");
  const goBackBtn = document.getElementById("goBack");
  const submitBtn = document.getElementById("submitBtnData");
  const closeErrorBtn = document.getElementById("closeError");

  if (!whiteBeanBtn || !minorBtn || !majorBtn || !goBackBtn || !submitBtn || !closeErrorBtn) {
    console.error("One or more critical elements not found in the DOM");
    return;
  }

  whiteBeanBtn.onclick = function(event) {
    event.preventDefault();
    console.log("White Bean clicked");
    const beanForm = document.getElementById("beanForm");
    if (beanForm) {
      beanForm.innerHTML = createFormFromBeansList("whiteNavy");
      toggleVisibility("whiteNavy");
      const selectAllBtn = document.getElementById("selectAllwhiteNavy");
      if (selectAllBtn) selectAllBtn.onclick = (e) => { e.preventDefault(); selectAllCheckboxes("whiteNavy"); };
    }
  };

  minorBtn.onclick = function(event) {
    event.preventDefault();
    console.log("Coloured Bean Minor clicked");
    const beanForm = document.getElementById("beanForm");
    if (beanForm) {
      beanForm.innerHTML = createFormFromBeansList("minorClass");
      toggleVisibility("minorClass");
      const selectAllBtn = document.getElementById("selectAllminorClass");
      if (selectAllBtn) selectAllBtn.onclick = (e) => { e.preventDefault(); selectAllCheckboxes("minorClass"); };
    }
  };

  majorBtn.onclick = function(event) {
    event.preventDefault();
    console.log("Coloured Bean Major clicked");
    const beanForm = document.getElementById("beanForm");
    if (beanForm) {
      beanForm.innerHTML = createFormFromBeansList("majorClass");
      toggleVisibility("majorClass");
      const selectAllBtn = document.getElementById("selectAllmajorClass");
      if (selectAllBtn) selectAllBtn.onclick = (e) => { e.preventDefault(); selectAllCheckboxes("majorClass"); };
    }
  };

  goBackBtn.onclick = function(event) {
    event.preventDefault();
    console.log("Go Back clicked");
    uncheckBoxes();
    resetView();
  };

  submitBtn.onclick = function(event) {
    event.preventDefault();
    console.log("Submit clicked");
    checkedBeans = [];
    const beanForm = document.getElementById("beanForm");
    if (beanForm) {
      let checkboxesBeans = beanForm.getElementsByTagName("input");
      for (let i = 0; i < checkboxesBeans.length; i++) {
        if (checkboxesBeans[i].checked) checkedBeans.push(checkboxesBeans[i].value);
      }
    }
    checkedData = [];
    const dataForm = document.getElementById("dataForm");
    if (dataForm) {
      let checkboxes = dataForm.getElementsByTagName("input");
      for (let i = 0; i < checkboxes.length; i++) {
        if (checkboxes[i].checked) checkedData.push(checkboxes[i].value);
      }
    }
    let beans = convertArrToBean(checkedBeans);
    console.log("Selected beans:", checkedBeans, "Selected data:", checkedData);
    if (beans.length < 2 || checkedData.length < 1) {
      showError();
    } else {
      const tables = document.getElementById("tables");
      if (tables) {
        tables.innerHTML = TABLE.createTables(beans, checkedData);
        tables.style.display = "block";
        document.querySelectorAll(".selectors, .buttons, .formInfo, #error").forEach(el => el.style.display = "none");
        setupTableButtons();
      }
    }
  };

  closeErrorBtn.onclick = function(event) {
    event.preventDefault();
    console.log("Close Error clicked");
    uncheckBoxes();
    resetView();
  };
}

function setupTableButtons() {
  console.log("Setting up table buttons...");
  const exportBtn = document.getElementById("exportCSV");
  const newCompBtn = document.getElementById("newComparison");

  if (exportBtn) exportBtn.onclick = (e) => { e.preventDefault(); exportAsCSV(); };
  if (newCompBtn) newCompBtn.onclick = (e) => { 
    e.preventDefault(); 
    console.log("Start a New Comparison clicked");
    const tables = document.getElementById("tables");
    if (tables) tables.innerHTML = "";
    uncheckBoxes();
    resetView();
  };
}

function toggleVisibility(className) {
  console.log(`Toggling visibility for ${className}`);
  document.querySelectorAll(".whiteNavy, .minorClass, .majorClass").forEach(el => el.style.display = "none");
  document.querySelectorAll(`.${className}`).forEach(el => el.style.display = "block");
  document.querySelectorAll(".selectors").forEach(el => el.style.display = "block");
  document.querySelectorAll(".form, .formInfo").forEach(el => el.style.display = "none");
  const error = document.getElementById("error");
  const tables = document.getElementById("tables");
  if (error) error.style.display = "none";
  if (tables) tables.style.display = "none";
}

function resetView() {
  console.log("Resetting view...");
  document.querySelectorAll(".whiteNavy, .minorClass, .majorClass, .selectors, #error, #tables").forEach(el => el.style.display = "none");
  document.querySelectorAll(".form, .formInfo, .buttons").forEach(el => el.style.display = "block");
}

function showError() {
  console.log("Showing error");
  document.querySelectorAll(".beanForm, .selectors, .buttons, .formInfo, .form").forEach(el => el.style.display = "none");
  const error = document.getElementById("error");
  const tables = document.getElementById("tables");
  if (error) error.style.display = "block";
  if (tables) tables.style.display = "none";
}

async function initializeComparisonTool() {
  console.log("Initializing comparison tool...");
  await loadBeanData();
  setupEventListeners();

  // Intersection Observer to re-initialize when section is visible
  const comparisonSection = document.querySelector(".crop-comparison");
  if (comparisonSection) {
    const observer = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting) {
        console.log("Crop comparison section is visible, re-checking event listeners...");
        setupEventListeners();
      }
    }, { threshold: 0.1 });
    observer.observe(comparisonSection);
  }
}

// Run initialization
document.addEventListener("DOMContentLoaded", initializeComparisonTool);
</script>